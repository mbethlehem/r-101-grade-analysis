---
title: "grade analysis"
format: html
---
```{r}
#| message: false

here::i_am("r-101-grade-analysis.Rproj")

library(here)
library(ggplot2)
library(tidyr)
library(dplyr)
library(vroom)
```

## Question 1

```{r}
#| message: false
grades <- vroom(here("grades.csv"))
```

## Question 2
```{r}
library(knitr)
```


```{r}
knitr::kable(grades |> summary("min"=min(Exam), "max"= max(Exam), "median"= median(Exam), "mean"= mean(Exam)))
```
```{r}
grades |> summarise("min"=min(Exam, na.rm=TRUE), "max"= max(Exam, na.rm=TRUE), "median"= median(Exam, na.rm=TRUE), "mean"= mean(Exam, na.rm=TRUE)) |> knitr::kable()
```
## Question 3

```{r}
num_absent <- grades |> filter(is.na(Exam))
```

There were  `r nrow(num_absent)` absent students. 

## Question 4
Represent graphically in an adapted way the distribution of grades at the Exam. Make sure to adapt the code to avoid any error or warning from ggplot2.

```{r}
grades_new <- grades |> filter(!is.na(Exam))
```
```{r}
grade_ <- grades |> filter(!is.na(Exam)) |> group_by(Exam) |> summarise(N=n())
```

```{r}
ggplot(grade_, aes(x=Exam, y=N)) + geom_col()
```
```{r}
ggplot(grades_new, aes(x=Exam)) + geom_boxplot()
```
## Question 5

Compute the number of students in each Group and include the results in your document as a table

```{r}
grades |> group_by(Group) |> summarise(N=n()) |> knitr::kable()
```
## Question 6

Represent the same information as in the previous question in a graphical way
```{r}
count_group <- grades |> group_by(Group) |> summarise(N=n())
```

```{r}
ggplot(count_group, aes(x=Group, y=N)) + geom_col()
```

## Question 7

Represent graphically the distribution of the grades at the Exam conditioned by the group. Test at least two different representations.

### Alternative 1
```{r}
ggplot(grades, aes(x=Exam, fill=Group)) + geom_bar(position="fill")
```
### Alternative 2

```{r}
ggplot(grades_new, aes(y=Exam, fill= Group)) + geom_boxplot()
```

